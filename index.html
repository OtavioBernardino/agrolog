<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AgroLog Pro Cloud - Master System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body class="pb-28">
    <h1 class="borda"></h1>

    <div id="toast-container" class="fixed top-24 left-1/2 -translate-x-1/2 z-[100] w-80 pointer-events-none space-y-2"></div>
    <div id="overlay" onclick="toggleMenu()" class="fixed inset-0 bg-black/80 backdrop-blur-sm z-[60] hidden"></div>

    <div id="side-menu" class="fixed top-0 left-0 h-full w-72 bg-slate-900 z-[70] shadow-2xl p-6 border-r border-slate-800">
        <div class="flex items-center gap-3 mt-10 mb-10">
            <div class="w-10 h-10 bg-yellow-500 rounded-xl flex items-center justify-center text-slate-950">
                <i class="fas fa-leaf text-xl"></i>
            </div>
            <h2 class="text-xl font-extrabold text-white tracking-tight">AGRO<span class="text-yellow-500">LOG</span></h2>
        </div>
        <nav class="space-y-1">
            <button onclick="navTo('dashboard')" class="w-full text-left p-4 hover:bg-slate-800 rounded-2xl flex gap-4 transition-all items-center"><i class="fas fa-th-large opacity-50"></i> Dashboard</button>
            <button onclick="navTo('relatorios')" class="w-full text-left p-4 hover:bg-slate-800 rounded-2xl flex gap-4 transition-all items-center text-purple-400"><i class="fas fa-chart-pie opacity-50"></i> Relatórios</button>
            <button onclick="navTo('config-rev')" class="w-full text-left p-4 hover:bg-slate-800 rounded-2xl flex gap-4 transition-all items-center text-orange-400"><i class="fas fa-screwdriver-wrench opacity-50"></i> Manutenção</button>
            <button onclick="navTo('cad-trator')" class="w-full text-left p-4 hover:bg-slate-800 rounded-2xl flex gap-4 transition-all items-center text-emerald-400"><i class="fas fa-truck-moving opacity-50"></i> Frota & Equipa</button>
        </nav>
    </div>

    <header class="bg-slate-950/50 backdrop-blur-md p-4 sticky top-0 z-50 flex justify-between items-center border-b border-slate-800/50 no-print">
        <button onclick="toggleMenu()" class="w-10 h-10 flex items-center justify-center rounded-full hover:bg-slate-800">
            <i class="fas fa-bars-staggered"></i>
        </button>
        <div class="flex flex-col items-center">
            <span class="text-[10px] font-bold text-yellow-500 tracking-[0.2em] uppercase">Cloud System</span>
            <h1 class="font-extrabold text-sm tracking-widest uppercase">Master Monitor</h1>
        </div>
        <div class="w-3 h-3 bg-emerald-500 rounded-full relative">
            <div class="absolute inset-0 bg-emerald-500 rounded-full animate-ping opacity-75"></div>
        </div>
    </header>

    <main class="p-4 max-w-2xl mx-auto space-y-6">
        <section id="dashboard" class="tab-content active">
            <div class="flex justify-between items-end mb-6">
                <div>
                    <h2 class="text-2xl font-extrabold text-white">Sua Frota</h2>
                    <p class="text-slate-500 text-sm">Status em tempo real</p>
                </div>
                <div class="text-right">
                    <span id="fleet-count" class="text-3xl font-black text-yellow-500">0</span>
                    <p class="text-[10px] uppercase font-bold text-slate-500">Ativos</p>
                </div>
            </div>
            <div id="fleet-list" class="grid grid-cols-1 gap-4"></div>
        </section>

        <section id="relatorios" class="tab-content">
            <div class="glass-card p-6 rounded-3xl space-y-6">
                <div class="flex justify-between items-start">
                    <h2 class="text-purple-400 font-extrabold text-lg italic uppercase tracking-tighter">Central Analytics</h2>
                    <button onclick="window.print()" class="w-10 h-10 bg-slate-800 rounded-xl flex items-center justify-center hover:bg-purple-600 transition-all"><i class="fas fa-file-pdf"></i></button>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <div class="bg-slate-900/50 p-4 rounded-2xl border border-slate-800">
                        <span class="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Total Período</span>
                        <div class="text-xl font-black text-white" id="kpi-total">0.0h</div>
                    </div>
                    <div class="bg-slate-900/50 p-4 rounded-2xl border border-slate-800">
                        <span class="text-[9px] font-bold text-slate-500 uppercase tracking-widest">Top Máquina</span>
                        <div class="text-sm font-black text-purple-400 truncate" id="kpi-top">---</div>
                    </div>
                </div>
                <div class="space-y-3">
                    <div class="flex p-1 bg-slate-900 rounded-2xl">
                        <button id="btn-diario" onclick="filtrarRelatorio('diario')" class="flex-1 py-2 text-[10px] font-bold uppercase rounded-xl transition-all">Hoje</button>
                        <button id="btn-mensal" onclick="filtrarRelatorio('mensal')" class="flex-1 py-2 text-[10px] font-bold uppercase rounded-xl transition-all">Mês</button>
                        <button id="btn-anual" onclick="filtrarRelatorio('anual')" class="flex-1 py-2 text-[10px] font-bold uppercase rounded-xl transition-all">Ano</button>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <select id="filtro-maquina-rel" onchange="atualizarPeriodoAtual()" class="bg-slate-950 p-3 rounded-xl border border-slate-800 text-[10px] font-bold text-slate-400 outline-none"></select>
                        <select id="filtro-operador-rel" onchange="atualizarPeriodoAtual()" class="bg-slate-950 p-3 rounded-xl border border-slate-800 text-[10px] font-bold text-slate-400 outline-none"></select>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        <div class="flex flex-col">
                            <label class="text-[8px] font-bold text-slate-600 ml-2 mb-1">DE:</label>
                            <input type="date" id="rel-data-inicio" onchange="filtrarRelatorio('custom')" class="bg-slate-950 p-2 rounded-xl border border-slate-800 text-[10px] text-white outline-none">
                        </div>
                        <div class="flex flex-col">
                            <label class="text-[8px] font-bold text-slate-600 ml-2 mb-1">ATÉ:</label>
                            <input type="date" id="rel-data-fim" onchange="filtrarRelatorio('custom')" class="bg-slate-950 p-2 rounded-xl border border-slate-800 text-[10px] text-white outline-none">
                        </div>
                    </div>
                </div>
                <div class="relative pt-4 border-t border-slate-800">
                    <canvas id="chartProd" style="max-height: 220px;"></canvas>
                </div>
                <div id="stats-list" class="grid grid-cols-1 gap-2"></div>
            </div>
        </section>

        <section id="config-rev" class="tab-content space-y-4">
            <div class="glass-card p-6 rounded-3xl border-l-4 border-orange-500">
                <h2 class="text-white font-bold mb-4 flex items-center gap-2"><i class="fas fa-layer-group text-orange-500"></i> Criar Plano</h2>
                <div class="flex gap-2">
                    <input type="text" id="rev-n" placeholder="Nome" class="flex-1 bg-slate-950 p-4 rounded-2xl border border-slate-800 text-sm outline-none">
                    <input type="number" id="rev-h" placeholder="Horas" class="w-24 bg-slate-950 p-4 rounded-2xl border border-slate-800 text-sm outline-none">
                    <button onclick="window.criarTipoRevisao(document.getElementById('rev-n').value, document.getElementById('rev-h').value)" class="bg-orange-600 w-14 rounded-2xl transition-all"><i class="fas fa-plus"></i></button>
                </div>
            </div>
            <div class="glass-card p-6 rounded-3xl">
                <h2 class="text-white font-bold mb-4">Vincular à Máquina</h2>
                <div class="space-y-3">
                    <select id="sel-t-vinc" class="w-full bg-slate-950 p-4 rounded-2xl border border-slate-800"></select>
                    <select id="sel-r-vinc" class="w-full bg-slate-950 p-4 rounded-2xl border border-slate-800"></select>
                    <button onclick="window.vincularRevisao(document.getElementById('sel-t-vinc').value, document.getElementById('sel-r-vinc').value)" class="w-full bg-white text-slate-950 py-4 rounded-2xl font-black uppercase text-xs hover:bg-orange-500 transition-all">Sincronizar</button>
                </div>
            </div>
        </section>

        <section id="lancamento" class="tab-content">
            <div class="glass-card p-8 rounded-[2.5rem] border border-yellow-500/20 shadow-2xl">
                <div class="text-center mb-8">
                    <div class="w-16 h-16 bg-yellow-500/10 rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-clock text-yellow-500 text-2xl"></i>
                    </div>
                    <h2 class="text-2xl font-black text-white uppercase italic">Apontamento</h2>
                    <p class="text-slate-500 text-xs">Sincronização imediata com a cloud</p>
                </div>
                <form id="form-h" class="space-y-4">
                    <select id="sel-t-lan" class="w-full bg-slate-950 p-4 rounded-2xl border border-slate-800 font-bold text-yellow-500"></select>
                    <select id="sel-o-lan" class="w-full bg-slate-950 p-4 rounded-2xl border border-slate-800"></select>
                    <div class="pt-4 bg-slate-950 rounded-2xl border border-slate-800">
                        <input type="number" step="0.1" id="h-input" placeholder="0000.0" class="w-full bg-transparent p-4 text-center text-7xl font-black text-white outline-none placeholder:text-slate-900">
                        <p class="text-center text-[10px] text-slate-600 font-bold uppercase tracking-widest">Leitura do Horímetro</p>
                    </div>
                    <button class="w-full bg-yellow-500 text-slate-950 py-5 rounded-3xl font-black uppercase shadow-xl active:scale-95 transition-all mt-6">Confirmar</button>
                </form>
            </div>
        </section>

        <section id="log-horas" class="tab-content space-y-4">
            <div class="glass-card p-4 rounded-3xl space-y-3">
                <div class="flex items-center gap-3 px-2">
                    <i class="fas fa-magnifying-glass text-slate-500"></i>
                    <input type="text" id="filter-search" oninput="render()" placeholder="Pesquisar máquina ou operador..." class="bg-transparent w-full outline-none text-sm">
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <input type="date" id="filter-date" onchange="render()" class="bg-slate-950 border border-slate-800 rounded-xl p-3 text-xs text-white">
                    <button onclick="clearFilters()" class="bg-slate-800 text-[10px] font-bold rounded-xl uppercase">Limpar</button>
                </div>
            </div>
            <div id="logs-list" class="space-y-3"></div>
        </section>

        <section id="cad-trator" class="tab-content space-y-6">
            <div class="glass-card p-6 rounded-3xl">
                <h2 class="text-emerald-400 font-bold mb-4 uppercase text-sm">Adicionar Máquina</h2>
                <div class="flex gap-2 mb-2">
                    <input type="text" id="t-mod-new" placeholder="Modelo" class="flex-1 bg-slate-950 p-4 rounded-2xl border border-slate-800">
                    <button onclick="window.salvarTrator(document.getElementById('t-mod-new').value, document.getElementById('t-hor-new').value)" class="bg-emerald-600 px-6 rounded-2xl transition-all"><i class="fas fa-check"></i></button>
                </div>
                <input type="number" id="t-hor-new" placeholder="Horas Atuais" class="w-full bg-slate-950 p-4 rounded-2xl border border-slate-800">
            </div>
            <div class="glass-card p-6 rounded-3xl">
                <h2 class="text-blue-400 font-bold mb-4 uppercase text-sm">Novo Operador</h2>
                <div class="flex gap-2">
                    <input type="text" id="o-nome-new" placeholder="Nome" class="flex-1 bg-slate-950 p-4 rounded-2xl border border-slate-800">
                    <button onclick="window.salvarOperador(document.getElementById('o-nome-new').value)" class="bg-blue-600 px-6 rounded-2xl transition-all"><i class="fas fa-user-plus"></i></button>
                </div>
            </div>
        </section>
    </main>

    <nav class="fixed bottom-6 left-4 right-4 bg-slate-900/80 backdrop-blur-xl border border-white/5 h-20 rounded-[2rem] flex justify-around items-center px-2 z-[55] shadow-2xl no-print">
        <button onclick="openTab('dashboard')" class="nav-btn flex flex-col items-center gap-1 text-slate-500 w-12 active" id="btn-tab-dashboard">
            <i class="fas fa-th-large text-xl"></i>
            <span class="text-[8px] font-bold uppercase">Frota</span>
        </button>
        <button onclick="openTab('relatorios')" class="nav-btn flex flex-col items-center gap-1 text-slate-500 w-12" id="btn-tab-relatorios">
            <i class="fas fa-chart-line text-xl"></i>
            <span class="text-[8px] font-bold uppercase">Relat</span>
        </button>
        <button onclick="openTab('lancamento')" class="relative -translate-y-8">
            <div class="bg-yellow-500 text-slate-950 w-14 h-14 rounded-2xl rotate-45 flex items-center justify-center shadow-xl shadow-yellow-500/20 active:scale-90 transition-all">
                <i class="fas fa-plus -rotate-45 text-2xl"></i>
            </div>
        </button>
        <button onclick="openTab('log-horas')" class="nav-btn flex flex-col items-center gap-1 text-slate-500 w-12" id="btn-tab-log-horas">
            <i class="fas fa-history text-xl"></i>
            <span class="text-[8px] font-bold uppercase">Logs</span>
        </button>
        <button onclick="openTab('cad-trator')" class="nav-btn flex flex-col items-center gap-1 text-slate-500 w-12" id="btn-tab-cad-trator">
            <i class="fas fa-cog text-xl"></i>
            <span class="text-[8px] font-bold uppercase">Config</span>
        </button>
    </nav>

    <script type="module" src="script.js"></script>
</body>
</html>
